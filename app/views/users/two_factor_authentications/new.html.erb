<div class="max-w-2xl mx-auto p-6">
  <h1 class="text-3xl font-bold mb-6">Setup Two-Factor Authentication</h1>

  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
    <p class="text-blue-800 font-semibold">Step 1: Scan QR Code</p>
    <p class="text-blue-700 text-sm mt-1">Use your authenticator app (Google Authenticator, Authy, etc.) to scan this QR code</p>
  </div>

  <div class="text-center mb-8">
    <%= @qr_code.as_svg(
      offset: 0,
      color: '000',
      shape_rendering: 'crispEdges',
      module_size: 6,
      standalone: true
    ).html_safe %>
  </div>

  <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
    <p class="text-gray-800 font-semibold mb-2">Manual Entry</p>
    <p class="text-gray-700 text-sm mb-2">If you can't scan the QR code, enter this secret key manually:</p>
    <code class="block bg-white p-2 rounded border border-gray-300 font-mono text-sm"><%= current_user.otp_secret %></code>
  </div>

  <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
    <p class="text-yellow-800 font-semibold mb-2">Step 2: Save Your Backup Codes</p>
    <p class="text-yellow-700 text-sm mb-3">Save these backup codes in a safe place. You can use them to access your account if you lose your authenticator device.</p>
    <div class="bg-white p-4 rounded border border-yellow-300">
      <% @backup_codes.each do |code| %>
        <div class="font-mono text-sm mb-1"><%= code %></div>
      <% end %>
    </div>
  </div>

  <%= form_with url: users_two_factor_authentication_path, method: :post, class: "space-y-4" do |f| %>
    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
      <p class="text-green-800 font-semibold mb-2">Step 3: Verify Setup</p>
      <p class="text-green-700 text-sm mb-3">Enter the 6-digit code from your authenticator app to complete setup:</p>

      <div>
        <%= f.label :otp_code, "Verification Code", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :otp_code,
            required: true,
            placeholder: "000000",
            maxlength: 6,
            class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 font-mono text-lg text-center",
            autocomplete: "off" %>
      </div>
    </div>

    <div class="flex gap-4">
      <%= f.submit "Enable Two-Factor Authentication", class: "px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold" %>
      <%= link_to "Cancel", users_two_factor_authentication_path, class: "px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold" %>
    </div>
  <% end %>
</div>
